## Reconstruction et analyse de la trajectoire des chromosomes en métaphase

L'analyse des mouvements des chromosomes permet d'inférer les mécanismes régulant la dynamique du fuseau mitotique. En effet l'ensemble des interactions physico-chimiques des toutes les molécules et protéines composant le fuseau permet l'émergence de phénomènes de plus haut niveau comme le mouvement et l'attachement des chromosomes durant la mitose. Tout ces mécanismes sont requis pour une division cellulaire stable et fidèle.

L'analyse du mouvement se déroule en trois étapes et peut être appliquées à un grand nombre de type de cellules différentes :

- Avant l'étape d'acquisition il est nécessaire de concevoir des cellule dont les kinétochores ou bien la partie centromérique de la chromatide de un ou plusieurs chromosomes sont marqués avec une sonde fluorescente. L'acquisition se déroule généralement à l'aide d'un microscope à champs large ou bien confocale dont on règle les paramètres d'acquisition afin d'obtenir une photo des cellules à des pas de temps défini. Plus le pas de temps est faible plus large sera l'éventail des phénomènes biophysiques observables. Cependant des pas de temps trop faible pendant un temps d’acquisition trop long aura tendance à abîmer les cellules par phototoxicité.

- L'étape de reconstruction de la trajectoire des chromosomes comprend la détection des différents éléments observés (souvent kinétochore et pôle du fuseau mitotique) pour chaque pas de temps suivi de la jointure des objets détectés dans le temps.

- Enfin la dernière étape d'analyse proprement dite n'est pas aussi bien défini que les deux étapes précédentes. Elle consiste à utiliser différents outils ou algorithmes afin de comparer et d'analyser les propriétés des trajectoires reconstruite afin d'en déduire différents mécanismes régulant la dynamique des chromosomes.

Cette stratégie d'analyse a été appliquée dans l'étude présentée en @sec:article. Ce qui suit propose de détailler les différents outils utilisés pour cette analyse ainsi que de présenter de nouvelles techniques d'analyse.

### La reconstruction des trois chromosomes de la levure à fission : un challenge ?

Après l'acquisition en vidéo-microscopie, la première étape consiste donc à détecter chacun des spots qui correspond à un kinétochore ou à un des deux pôles du fuseau mitotique.

La résolution de la vidéo-microscopie actuelle ainsi que la taille du fuseau mitotique de la levure à fission (entre 1 et 4μm) rend la différenciation entre les six kinétochores très difficile tout au long de la métaphase ([@fig:spindle_peaks]A).

Il est possible de visualiser uniquement un chromosome en utilisant une sonde fluorophore situer sur une zone spécifique de ce chromosome au niveau de sa partie péri-centromérique. Une lignée pré-existante [@Yamamoto2003] a donc été utilisé afin de marquer le chromosome II de la levure à fission à l'aide d'un système LacO/LacI [@Robinett1996]. Cette lignée permet une différenciation beaucoup plus facile entre les deux kinétochores du chromosome visualisé ([@fig:spindle_peaks]B).

![Image en microscopie à fluorescence de deux fuseaux mitotiques. __A__. Cellule marqué en GFP pour les six kinétochores (Ndc80-GFO, en vert sur le schéma) et pour les pôles (Cdc11-GFP, en rouge sur le schéma). __B__. Cellule marqué en GFP pour le centromère du chromosome II (Cen2-GFP, en vert sur le schéma) et pour les pôles (Cdc11-GFP, en rouge sur le schéma). La barre d’échelle correspond à 1μm.](figures/results/imaging/spindle_peaks.png "Image en microscopie à fluorescence de deux fuseaux mitotique"){#fig:spindle_peaks}

De l'information est donc perdu (la position des kinétochores des deux autres chromosomes) au profit d'une précision très fortement accru de la position des deux kinétochores restant.

Enfin on remarque que la visualisation des pôles se fait dans la même longueur d'onde que les kinétochores (marqués en GFP) afin de ne pas avoir à imager dans deux longueurs d'ondes différentes dans le but de réduire les dommages causés par la phototoxicité du système d'acquisition ainsi que de réduire le temps d'intervalle minimal entre deux acquisitions.

#### Détection par fit gaussien

En imagerie on définit un blob comme étant « une région d'une image formée par un ensemble de pixels connectés spatialement ». Plus communément un blob est un point qui correspond à une région intéressante de l'image. Par exemple, [@fig:spindle_peaks]B contient quatre blobs, deux correspondant aux pôles du fuseau mitotique et deux autres correspondant à la partie péri-centromérique des deux chromatides sœurs du chromosome II. L'étape de la détection est d'arriver à obtenir les propriétés géométriques de ces quatre objets (position, largeur et intensité).

L'un des algorithmes les plus utilisés pour la détection de blob se base sur la convolution de l'image par un noyau Gaussien suivi de l'application de l'opérateur Laplacien (on parle de « Laplacian of Gaussian » en anglais ^[[https://en.wikipedia.org/wiki/Blob_detection#The_Laplacian_of_Gaussian](https://en.wikipedia.org/wiki/Blob_detection#The_Laplacian_of_Gaussian)]). Cette approche est très précise mais est aussi très sensible au paramètre d’échelle, c'est à dire que son résultat va fortement dépendre de la relation entre la taille des structures des blobs et la taille du noyau gaussien.

L'idée de convoluer l'image source avec un noyau gaussien vient de l'observation que les blobs des sondes utilisées en biologie peuvent parfois avoir une forme qui s'approche d'une distribution gaussienne en deux dimensions ([@fig:gaussian]).

La qualité de la détection dépend aussi de la qualité du ratio signal/bruit de l'image ainsi que de la fidélité de la sonde fluorescente à reproduire une distribution gaussienne. Par exemple on peut remarquer que la sonde Cen2-GFP ([@fig:gaussian]B) possède souvent une gaussienne moins bien défini que la sonde Cdc11-GFP ([@fig:gaussian]C)). Ceci pourrait être causé par le fait que la sonde Cen2-GFP consiste en une répétition d'insertion d'un gène (LacO) le long de la partie péri-centromérique du chromosome II. Il en résulterait un signal moins centré autour d'un unique point de l'espace et plus diffus dans la longueur du chromosome.

![Distribution des intensités gaussiennes en deux dimensions. __A__. Cet image a été généré _in silico_ par l’échantillonnage aléatoire d'une distribution gaussienne. Le surface plot (image de droite) contient une dimension supplémentaire en $z$ dont la hauteur est proportionnelle à l'intensité des pixels dans l'image originale (image de gauche) . __B__. Cette image correspond à un blob de la sonde Cen2-GFP qui marque le centromère d'une des chromatides du chromosome II.  __C__. Cette image correspond à un blob de la sonde Cdc11-GFP qui marque les deux pôles du fuseau mitotique.](figures/results/imaging/gaussian.png "Distribution des intensités gaussiennes en deux dimensions"){#fig:gaussian}

Une implémentation existe dans le plugin TrackMate inclus dans Fiji [@Schindelin2012]. Son code est librement disponible ^[[http://git.io/vC9zf](http://git.io/vC9zf)].

Cette implémentation a été utilisé pour l'analyse des images de vidéo-microscopie durant ce travail. La précision de la détection a aussi été testé en détectant des faux films générés depuis des trajectoires simulées _in silico_ ([@fig:detection_precision]A). La distance entre la position réelle _in silico_ puis la position détectée a ensuite été comparé ([@fig:detection_precision]B). La largeur à mi hauteur (FWHM, _full width at half maximum_) de la distribution de l'erreur de détection est d'à peu près 34nm.

![Précision de la détection des blobs. __A__. Superposition d'une trajectoire de chromosome et pôle simulée _in silico_ (en rouge) avec la trajectoire reconstruire par détection de blob (en vert). __B__. Distribution de la distance entre les blobs simulés et les blobs détectés.](figures/results/imaging/detection_precision.png "Précision de la détection des blobs"){#fig:detection_precision}

Enfin un autre algorithme de détection de blob a aussi testé durant ce travail. Il est basé sur le travail de Sergé et al. [@Serge2008] dont le principal atout consiste à être capable de détecter plusieurs blobs très proche les uns des autres comme cela peut être le cas lorsque on visualise les six kinétochores de la levure à fission ([@fig:spindle_peaks]A).

L'idée principale est d'appliquer une algorithme de détection de blob plusieurs fois. Entre chaque tour de détection, on soustrait les blobs détectés à l'image source et on re-détecte les blobs restant (@fig:deflation). L'algorithme s'arrête quand plus aucun blob n'est détecté dans l'image. Cela permet la détection des blobs d'intensité plus faible qui sont masqués par un blob de plus forte intensité proche de celui-ci.

![Principe de l'algorithme de détection de blob par déflation. __A__. Le premier tour de fit gaussien détecte le blob le plus grand et le plus intense. __B__. Une fois le premier blob détecté soustrait de l'image source, le second tour de fit gaussien détecte le blob plus petit et moins intense. Les line plots situés à droite des schémas sont adaptés de @Serge2008.](figures/results/imaging/deflation.png "Principe de l'algorithme de détection de blob par déflation"){#fig:deflation}

Une implémentation en Python de cet algorithme est librement disponible en ligne ^[[http://git.io/vCHGs](http://git.io/vCHGs)].

Deux raisons ont empêchés cet algorithme d'être utilisé dans le cadre de ce travail. La première est que l'implémentation en Python est beaucoup plus lente (quasiment un facteur 100) que la détection de blob proposé par le plugin TrackMate. Afin de remédier à cela il faudrait ré-implémenter l'algorithme de façon plus efficace, probablement en utilisant un langage plus bas niveau tel que le Cython ou le C. Cette perte de temps aurait pu éventuellement être acceptable si la détection de blobs superposés dans les images à six kinétochores ([@fig:spindle_peaks]A) fonctionnait bien. Or l'algorithme de déflation ne donne pas de résultat convaincant comparé à ceux de TrackMate (@fig:compare). Ceci pourrait s'expliquer par le fait que la déflation est réellement efficace sur des sondes à molécules unique (« Single Particle Tracking » ou aussi SPT en anglais) et non pas des agrégats de multiples sondes fluorophores comme c'est le cas pour Cen2-GFP et Cdc11-GFP.

![Comparaison entre le LoG détection de TrackMate et l'implémentation par déflation basé sur l'algorithme de Sergé et al. Aucun n'est deux algorithmes n'arrivent à détecter les six kinétochores et les deux pôles. Par contre l'algorithme de TrackMate (à droite) détecte cinq kinétochores et les deux pôles. Alors que l'autre algorithme (à gauche) fait plus d'erreurs en détectant deux pôles au lieu de un (en haut) et en omettant un kinétochore au milieu.](figures/results/imaging/compare.png "Principe de l'algorithme de détection de blob par déflation"){#fig:compare}

Une fois les blobs détectés pour chaque pas de temps, il faut encore relié chaque blob avec son blob correspondant dans le temps afin d'obtenir les trajectoires uniques de chaque chromosomes et des pôles; c'est l'étape de tracking.

#### Reconstruction des trajectoires

![Le tracking est l'étape de liaison des objets d’intérêts  dans le temps. Sans cette étape il est impossible de savoir si un objet est le même que un autre dans deux temps différents.](figures/results/imaging/whatistracking.png "Le tracking est l'étape de liaison des objets d’intérêts  dans le temps"){#fig:whatistracking}

##### Trois chromosomes

##### Un chromosome

##### Interface de correction manuelle des trajectoires

#### Le projet `scikit-tracker`

- gui pr modif manuelle des trajectoires

#### Résumé du workflow de reconstruction des trajectoires

![Workflow de reconstruction des trajectoires. Deux étapes nécessitent une intervention manuelle. Suite à la détection de blobs (peaks) et après la reconstruction automatique des trajectoires.](figures/results/imaging/workflow.png "Workflow de reconstruction des trajectoires"){#fig:workflow}

### Analyse du signal appliquée aux trajectoires des chromosomes

- auto corrélation vite fait
- fft avec les techniques

### L'état de cohérence du mouvement des kinétochores frères

- présenter l'algo et qq resultats

### Analyse du mouvement par « Mean Square Displacement »

- broder aussi un truc avec des MSD toussa toussa
