## Reconstruction et analyse de la trajectoire des chromosomes en métaphase

L'analyse des mouvements des chromosomes permet d'inférer les mécanismes régulant la dynamique du fuseau mitotique. En effet l'ensemble des interactions physico-chimiques des toutes les molécules et protéines composant le fuseau permet l'émergence de phénomènes de plus haut niveau comme le mouvement et l'attachement des chromosomes durant la mitose. Tout ces mécanismes sont requis pour une division cellulaire stable et fidèle.

L'analyse du mouvement se déroule en trois étapes et peut être appliquées à un grand nombre de type de cellules différentes :

- Avant l'étape d'acquisition il est nécessaire de concevoir des cellule dont les kinétochores ou bien la partie centromérique de la chromatide de un ou plusieurs chromosomes sont marqués avec une sonde fluorescente. L'acquisition se déroule généralement à l'aide d'un microscope à champs large ou bien confocale dont on règle les paramètres d'acquisition afin d'obtenir une photo des cellules à des pas de temps défini. Plus le pas de temps est faible plus large sera l'éventail des phénomènes biophysiques observables. Cependant des pas de temps trop faible pendant un temps d’acquisition trop long aura tendance à abîmer les cellules par phototoxicité.

- L'étape de reconstruction de la trajectoire des chromosomes comprend la détection des différents éléments observés (souvent kinétochore et pôle du fuseau mitotique) pour chaque pas de temps suivi de la jointure des objets détectés dans le temps.

- Enfin la dernière étape d'analyse proprement dite n'est pas aussi bien défini que les deux étapes précédentes. Elle consiste à utiliser différents outils ou algorithmes afin de comparer et d'analyser les propriétés des trajectoires reconstruites afin d'en déduire différents mécanismes régulant la dynamique des chromosomes.

Cette stratégie d'analyse a été appliquée dans l'étude présentée en @sec:article. Ce qui suit propose de détailler les différents outils utilisés ainsi que de présenter de nouvelles techniques d'analyse.

### La reconstruction des trois chromosomes de la levure à fission : un challenge ?

Après l'acquisition en vidéo-microscopie, la première étape consiste donc à détecter chacun des spots qui correspond à un kinétochore ou à un des deux pôles du fuseau mitotique.

La résolution de la vidéo-microscopie actuelle ainsi que la taille du fuseau mitotique de la levure à fission (entre 1 et 4μm) rend la différenciation entre les six kinétochores très difficile tout au long de la métaphase ([@fig:spindle_peaks]A).

Il est possible de visualiser uniquement un chromosome en utilisant une sonde fluorophore situer sur une zone spécifique de ce chromosome au niveau de sa partie péri-centromérique. Une lignée pré-existante [@Yamamoto2003] a donc été utilisé afin de marquer le chromosome II de la levure à fission à l'aide d'un système LacO/LacI [@Robinett1996]. Cette lignée permet une différenciation beaucoup plus facile entre les deux kinétochores du chromosome visualisé ([@fig:spindle_peaks]B).

![Image en microscopie à fluorescence de deux fuseaux mitotiques. __A__. Cellule marqué en GFP pour les six kinétochores (Ndc80-GFO, en vert sur le schéma) et pour les pôles (Cdc11-GFP, en rouge sur le schéma). __B__. Cellule marqué en GFP pour le centromère du chromosome II (Cen2-GFP, en vert sur le schéma) et pour les pôles (Cdc11-GFP, en rouge sur le schéma). La barre d’échelle correspond à 1μm.](figures/results/imaging/spindle_peaks.png "Image en microscopie à fluorescence de deux fuseaux mitotique"){#fig:spindle_peaks}

De l'information est donc perdu (la position des kinétochores des deux autres chromosomes) au profit d'une précision très fortement accru de la position des deux kinétochores restant.

Enfin on remarque que la visualisation des pôles se fait dans la même longueur d'onde que les kinétochores (marqués en GFP) afin de ne pas avoir à imager dans deux longueurs d'ondes différentes dans le but de réduire les dommages causés par la phototoxicité du système d'acquisition ainsi que de réduire le temps d'intervalle minimal entre deux acquisitions.

#### Détection par fit gaussien

En imagerie on définit un blob comme étant « une région d'une image formée par un ensemble de pixels connectés spatialement ». Plus communément un blob est un point qui correspond à une région intéressante de l'image. Par exemple, [@fig:spindle_peaks]B contient quatre blobs, deux correspondant aux pôles du fuseau mitotique et deux autres correspondant à la partie péri-centromérique des deux chromatides sœurs du chromosome II. L'étape de la détection est d'arriver à obtenir les propriétés géométriques de ces quatre objets (position, largeur et intensité).

L'un des algorithmes les plus utilisés pour la détection de blob se base sur la convolution de l'image par un noyau Gaussien suivi de l'application de l'opérateur Laplacien (on parle de « Laplacian of Gaussian » en anglais ^[[https://en.wikipedia.org/wiki/Blob_detection#The_Laplacian_of_Gaussian](https://en.wikipedia.org/wiki/Blob_detection#The_Laplacian_of_Gaussian)]). Cette approche est très précise mais est aussi très sensible au paramètre d’échelle, c'est à dire que son résultat va fortement dépendre de la relation entre la taille des structures des blobs et la taille du noyau gaussien.

L'idée de convoluer l'image source avec un noyau gaussien vient de l'observation que les blobs des sondes utilisées en biologie peuvent parfois avoir une forme qui s'approche d'une distribution gaussienne en deux dimensions ([@fig:gaussian]).

La qualité de la détection dépend aussi de la qualité du ratio signal/bruit de l'image ainsi que de la fidélité de la sonde fluorescente à reproduire une distribution gaussienne. Par exemple on peut remarquer que la sonde Cen2-GFP ([@fig:gaussian]B) possède souvent une gaussienne moins bien défini que la sonde Cdc11-GFP ([@fig:gaussian]C)). Ceci pourrait être causé par le fait que la sonde Cen2-GFP consiste en une répétition d'insertion d'un gène (LacO) le long de la partie péri-centromérique du chromosome II. Il en résulterait un signal moins centré autour d'un unique point de l'espace et plus diffus dans la longueur du chromosome.

![Distribution des intensités gaussiennes en deux dimensions. __A__. Cet image a été généré _in silico_ par l’échantillonnage aléatoire d'une distribution gaussienne. Le surface plot (image de droite) contient une dimension supplémentaire en $z$ dont la hauteur est proportionnelle à l'intensité des pixels dans l'image originale (image de gauche) . __B__. Cette image correspond à un blob de la sonde Cen2-GFP qui marque le centromère d'une des chromatides du chromosome II.  __C__. Cette image correspond à un blob de la sonde Cdc11-GFP qui marque les deux pôles du fuseau mitotique.](figures/results/imaging/gaussian.png "Distribution des intensités gaussiennes en deux dimensions"){#fig:gaussian}

Une implémentation existe dans le plugin TrackMate inclus dans Fiji [@Schindelin2012]. Son code est librement disponible ^[[http://git.io/vC9zf](http://git.io/vC9zf)].

Cette implémentation a été utilisé pour l'analyse des images de vidéo-microscopie durant ce travail. La précision de la détection a aussi été testé en détectant des faux films générés depuis des trajectoires simulées _in silico_ ([@fig:detection_precision]A). La distance entre la position réelle _in silico_ puis la position détectée a ensuite été comparé ([@fig:detection_precision]B). La largeur à mi hauteur (FWHM, _full width at half maximum_) de la distribution de l'erreur de détection est d'à peu près 34nm.

![Précision de la détection des blobs. __A__. Superposition d'une trajectoire de chromosome et pôle simulée _in silico_ (en rouge) avec la trajectoire reconstruire par détection de blob (en vert). __B__. Distribution de la distance entre les blobs simulés et les blobs détectés.](figures/results/imaging/detection_precision.png "Précision de la détection des blobs"){#fig:detection_precision}

Enfin un autre algorithme de détection de blob a aussi testé durant ce travail. Il est basé sur le travail de Sergé et al. [@Serge2008] dont le principal atout consiste à être capable de détecter plusieurs blobs très proche les uns des autres comme cela peut être le cas lorsque on visualise les six kinétochores de la levure à fission ([@fig:spindle_peaks]A).

L'idée principale est d'appliquer un algorithme de détection de blob plusieurs fois. Entre chaque tour de détection, on soustrait les blobs détectés à l'image source et on re-détecte les blobs restant (@fig:deflation). L'algorithme s'arrête quand plus aucun blob n'est détecté dans l'image. Cela permet la détection des blobs d'intensité plus faible qui sont masqués par un blob de plus forte intensité proche de celui-ci.

![Principe de l'algorithme de détection de blob par déflation. __A__. Le premier tour de fit gaussien détecte le blob le plus grand et le plus intense. __B__. Une fois le premier blob détecté soustrait de l'image source, le second tour de fit gaussien détecte le blob plus petit et moins intense. Les line plots situés à droite des schémas sont adaptés de @Serge2008.](figures/results/imaging/deflation.png "Principe de l'algorithme de détection de blob par déflation"){#fig:deflation}

Une implémentation en Python de cet algorithme est librement disponible en ligne ^[[http://git.io/vCHGs](http://git.io/vCHGs)].

Deux raisons ont empêchés cet algorithme d'être utilisé dans le cadre de ce travail. La première est que l'implémentation en Python est beaucoup plus lente (quasiment un facteur 100) que la détection de blob proposée par le plugin TrackMate. Afin de remédier à cela il faudrait ré-implémenter l'algorithme de façon plus efficace, probablement en utilisant un langage plus bas niveau tel que Cython ou le C. Cette perte de temps aurait pu éventuellement être acceptable si la détection de blobs superposés dans les images à six kinétochores ([@fig:spindle_peaks]A) fonctionnait bien. Or l'algorithme de déflation ne donne pas de résultat convaincant comparé à celui proposé par TrackMate (@fig:compare). Ceci pourrait s'expliquer par le fait que la déflation est réellement efficace sur des sondes à molécules unique (« Single Particle Tracking » ou aussi SPT en anglais) et non pas des agrégats de multiples sondes fluorophores comme c'est le cas pour Cen2-GFP.

![Comparaison entre le LoG détection de TrackMate et l'implémentation par déflation basé sur l'algorithme de Sergé et al. Aucun n'est deux algorithmes n'arrivent à détecter les six kinétochores et les deux pôles. Par contre l'algorithme de TrackMate (à droite) détecte cinq kinétochores et les deux pôles. Alors que l'autre algorithme (à gauche) fait plus d'erreurs en détectant deux pôles au lieu de un (en haut) et en omettant un kinétochore au milieu.](figures/results/imaging/compare.png "Principe de l'algorithme de détection de blob par déflation"){#fig:compare}

Une fois les blobs détectés pour chaque pas de temps, il faut encore relié chaque blob avec son blob correspondant dans le temps afin d'obtenir les trajectoires uniques de chaque chromosomes et des pôles; c'est l'étape de tracking.

#### Reconstruction des trajectoires

Durant le tracking, les trajectoires des objets observés (les chromosomes et les pôles) sont reconstruites. C'est à dire que chaque blob est relié avec le blob qui correspond au même objet dans tout les pas de temps (@fig:whatistracking).

![Le tracking est l'étape de liaison des objets d’intérêts  dans le temps. Sans cette étape il est impossible de savoir si un objet est le même que un autre dans deux temps différents.](figures/results/imaging/whatistracking.png "Le tracking est l'étape de liaison des objets d’intérêts  dans le temps"){#fig:whatistracking}

Tout les algorithmes de tracking sont basé sur la même idée que d'un pas de temps à l'autre, deux blobs correspondent au même objet si leurs distances est la plus petite parmi toutes les distances possibles avec les autres blobs.

Le tracking consiste donc à minimiser un ensemble de solutions parmi le champ des possibles. La version la plus utilisée se base sur la minimisation de la distance euclidienne d'un pas de temps à l'autre.

##### Trois chromosomes

Le tracking des six kinétochores est un challenge. En effet comme déjà vu en [@fig:spindle_peaks]A, les six kinétochores évoluent ensemble dans un espace de petite taille, le fuseau mitotique. De plus ils ont tendance à se superposer très souvent. On notera qu'il n'est pas possible de les différencier même en filmant dans la profondeur du champs focal (en $z$).

Cependant il est possible de reconstruire partiellement des morceaux de trajectoires. Pour cela il est possible d'utiliser un framework générale de tracking de particules développé par Jaqaman et al. appelé le LAP tracker pour _Linear Assignement Problem tracker_ (@Jaqaman2008).

L'idée du LAP tracker est de minimiser successivement deux matrices de coût contenant l'ensemble des solutions possibles au problème (@fig:jaqaman).

![Les deux matrices de coût du LAP tracker. __A__. Matrice de coût contentant l'ensemble des liens possibles entre deux blobs pour deux pas de temps successifs $t$ et $t+1$. Il existe donc autant de cette première matrice que de pas de temps dans la trajectoire. Le bloc en bas à droite (LRB) est un bloc auxiliaire requis pour satisfaire des contraintes topologiques de l'algorithme. __B__. Matrice de coût contrôlant la fermeture des trous, la fusion et la séparation des trajectoires. Adapté de @Jaqaman2008.](figures/results/imaging/jaqaman.png "Les deux matrices de coût du LAP tracker"){#fig:jaqaman}

Dans la première matrice ([@fig:jaqaman]A), chaque ligne et colonne correspond à un blob allant de de $1$ à $n_{t+1}$ pour deux pas de temps successifs $t$ et $t+1$. Chaque intersection de la matrice va contenir un score qui va mesurer la probabilité que l’événement en question arrive. Par exemple pour le bloc en haut à gauche (le bloc de liaison), chaque case correspond à un événement de liaison entre les deux blobs correspondant. Tandis que dans le bloc en bas à gauche, le score correspond à la probabilité que ce blob soit le premier d'un trajectoire (c'est à dire qu'il n'est lié a aucun autre blob dans le passé), on parle alors de « birth ». Le bloc en haut à droite correspond aux probabilités de mort d'une trajectoire, c'est à dire que le blob soit le dernier d'une trajectoire (pas de liaison dans le futur), on parle alors de « death ».

Le score du bloc de liaison peut être défini de plusieurs manières. Si on suppose un mouvement brownien on peut simplement définir le score comme la distance au carré qui séparent les deux particules. Si on étudie un mouvement dirigé on peut utiliser par exemple un score basé sur la distance entre le blob $t+1$ et une position prédite et probable qui correspondrait à un mouvement dirigé (basé sur un filtre de Kalman par exemple).

Une fois les matrices crées (on note qu'il existe $t-1$ matrices dans le cas de la première matrice). Elles sont minimisés en utilisant l'algorithme de Jonker-Volgenant (@Jonker1987). La minimisation des matrices va alors calculer la combinaison des événements les plus probables en se basant sur les scores. On obtient ainsi des trajectoires.

La seconde matrice ([@fig:jaqaman]B) gère des événements plus complexes liés aux trajectoires et non plus aux blobs. Ici chaque ligne et colonne correspond à une trajectoire. Le calcul des scores cherche à exprimer la probabilité d’événements tel que le lien entre le début d'une trajectoire et la fin d'une autre, la fusion ou la séparation de deux trajectoires.

Deux implémentations ont été testées ([@fig:ndc80]). La première provenant d'un module Python crée pour l'occasion, appelé `scikit-tracker`, possédant une fonction de score supposant un mouvement brownien ([@fig:ndc80]A). La seconde est celle disponible dans TrackMate et contient une fonction de score qui suppose un mouvement dirigé basé sur un filtre de Kalman pour prédire les trajectoires ([@fig:ndc80]B).

![Reconstruction de la trajectoire avec six kinétochores. __A__. La reconstruction est basé sur une implémentation développé dans le cadre de cette étude appelé `scikit-tracker`. __B__. Reconstruction avec le plugin Fiji nommé TrackMate.](figures/results/imaging/ndc80.png "Reconstruction de la trajectoire avec six kinétochores"){#fig:ndc80}

On observe que certains morceaux de trajectoires sont correctement reconstruits. Cependant dans les deux reconstructions, les six kinétochores ne sont jamais clairement visibles. Soit certains sont superposés à d'autre et donc ils apparaissent comme un unique blob, soit certains d'entre eux sortent du champ focal du microscope. Il est très compliqué de différencier entre les deux scénarios.

Afin d'obtenir des trajectoires exacts de chromosomes tout au long de la mitose l'une des solutions est d'imager seulement les deux kinétochores d'un seul chromosome.

##### Un chromosome

En observant seulement un seul chromosome ([@fig:spindle_peaks]B), la détection des blobs et la tracking deviennent beaucoup plus facile et robuste. En présence de seulement quatre blobs on peut alors facilement concevoir un algorithme simple et qui fonctionne dans la majorité des cas.

Cette approche a été utilisée dans la majorité des reconstructions de trajectoire de chromosomes utilisées dans ce travail.

L'algorithme utilisé est le suivant (@fig:algo_cen2) :

- pour chaque pas de temps, on détermine les deux blobs les plus éloignés. Ils sont marqués comme étant les pôles du fuseau. Les deux autres blobs restant sont marqués comme étant les kinétochores.

- un côté (droite ou gauche) est assigné à chacun des pôles. Le kinétochore le plus proche de lui se voit assigner le côté correspondant.

![Algorithme de tracking pour un chromosome.](figures/results/imaging/algo_cen2.png "Algorithme de tracking pour un chromosome"){#fig:algo_cen2}

Cette technique est très robuste (@fig:cen2). Cependant il arrive parfois que quelques erreurs subsistent dans les trajectoires. On peut alors avoir recours à une interface de correction manuelle des trajectoires.

![Reconstruction de la trajectoire du chromosome II et de ces deux pôles.](figures/results/imaging/cen2.png "Reconstruction de la trajectoire du chromosome II et de ces deux pôles."){#fig:cen2}

##### Interface de correction manuelle des trajectoires

Afin de pouvoir facilement corriger les trajectoires des chromosomes contenant des erreurs qu'ils auraient été dommage d'écarter de l'analyse, il a été développé une interface graphique de correction manuelle. Cette interface écrite en Python est basé sur la bibliothèque `pyqtgraph` ^[[www.pyqtgraph.org](www.pyqtgraph.org)]. Son code est librement disponible ^[[http://git.io/vCNxh](http://git.io/vCNxh)].

L'interface permet de naviguer de manière intuitive dans la trajectoire à l'aide d'un système de zoom dynamique (@fig:gui). Il est possible de visualiser en deux dimensions n'importe quelle information contenue dans la trajectoire telles que le temps, la position en $x$, $y$ et $z$ (si disponible), la taille et l'intensité des blobs, etc. Elle permet aussi d'annoter les trajectoires en leur donnant une note comprise entre un et trois décrivant la qualité de la trajectoire. Enfin il est possible de spécifier le début de l'anaphase ([@fig:gui]A) afin de pouvoir faciliter l'analyse automatique des différentes phases de la mitose ultérieurement.

Cependant l'utilité majeure de l'interface graphique est de pouvoir modifier les erreurs de tracking ([@fig:gui]B). Ainsi il est possible de sélectionner un ou plusieurs blobs en même temps afin de les supprimer. On peut aussi sélectionner deux trajectoires afin de les raccorder, de les fusionner ou bien de les séparer.

![Interface graphique de correction manuelle des trajectoires. __A__. Le début de l'anaphase peut être modifier manuellement. __B__. Chaque trajectoire peut être modifié à l'aide d'une interface simple et intuitive.](figures/results/imaging/gui.png "Interface graphique de correction manuelle des trajectoires"){#fig:gui}

#### Résumé du workflow de reconstruction des trajectoires

Voici un résumé de l'ensemble des étapes menant à la reconstruction de la trajectoire des chromosomes (@fig:workflow). En entrée on a un film issu de la vidéo-microscopie à fluorescence contenant la dynamique des chromosomes et des pôles du fuseau mitotique durant la mitose. En sortie on a la trajectoires de chacun des objets qui contient les positions ainsi que les propriétés géométriques des blobs pour chaque pas de temps.

![Workflow de reconstruction des trajectoires. Deux étapes nécessitent une intervention manuelle. Suite à la détection de blobs (peaks) et après la reconstruction automatique des trajectoires.](figures/results/imaging/workflow.png "Workflow de reconstruction des trajectoires"){#fig:workflow}

La constitution d'une base de donnée de trajectoires contenant différentes souches cellulaires permet par la suite de comparer les différents groupes de trajectoires afin d'en extraire leurs principales propriétés biophysiques.

### L'état de cohérence du mouvement des kinétochores frères

En plus des propriétés oscillatoires telles que l'amplitude ou la période des mouvements (voir @sec:article pour des résultats), il est aussi possible d'analyser la cohérence du mouvement des kinétochores (@Armond2015).

On définit la cohérence d'un mouvement pour deux kinétochores frères comme étant l'état de synchronisation du mouvement de chaque kinétochore en fonction de son kinétochore frère. Par exemple si un kinétochore a un mouvement poleward, le mouvement du chromosome est cohérent si son kinétochore frère à un mouvement anti-poleward.



### Analyse du mouvement par « Mean Square Displacement »

- broder aussi un truc avec des MSD toussa toussa


